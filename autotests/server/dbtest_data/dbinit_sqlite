CREATE TABLE SchemaVersionTable (version INTEGER NOT NULL DEFAULT 0,
                                 generation INTEGER NOT NULL DEFAULT 0)

INSERT INTO SchemaVersionTable (version) VALUES (36)

CREATE TABLE ResourceTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                            name TEXT UNIQUE NOT NULL,
                            isVirtual BOOL DEFAULT 0)

INSERT INTO ResourceTable (isVirtual,name) VALUES (1,'akonadi_search_resource')

CREATE TABLE CollectionTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                              remoteId TEXT,
                              remoteRevision TEXT,
                              name TEXT NOT NULL,
                              parentId BIGINT,
                              resourceId BIGINT NOT NULL,
                              enabled BOOL NOT NULL DEFAULT 1,
                              syncPref TINYINT DEFAULT 2,
                              displayPref TINYINT DEFAULT 2,
                              indexPref TINYINT DEFAULT 2,
                              referenced BOOL NOT NULL DEFAULT 0,
                              cachePolicyInherit BOOL NOT NULL DEFAULT 1,
                              cachePolicyCheckInterval INTEGER NOT NULL DEFAULT -1,
                              cachePolicyCacheTimeout INTEGER NOT NULL DEFAULT -1,
                              cachePolicySyncOnDemand BOOL NOT NULL DEFAULT 0,
                              cachePolicyLocalParts TEXT,
                              queryString TEXT,
                              queryAttributes TEXT,
                              queryCollections TEXT,
                              isVirtual BOOL DEFAULT 0)

INSERT INTO CollectionTable (isVirtual,name,parentId,resourceId) VALUES (1,'Search',NULL,1)

CREATE TABLE MimeTypeTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                            name TEXT UNIQUE NOT NULL)

CREATE TABLE PimItemTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                           rev INTEGER NOT NULL DEFAULT 0,
                           remoteId TEXT,
                           remoteRevision TEXT,
                           gid TEXT,
                           collectionId BIGINT,
                           mimeTypeId BIGINT,
                           datetime TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                           atime TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                           dirty BOOL,
                           size BIGINT NOT NULL DEFAULT 0)

CREATE TABLE FlagTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                        name TEXT UNIQUE NOT NULL)

CREATE TABLE PartTypeTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                            name TEXT NOT NULL,
                            ns TEXT NOT NULL)

CREATE TABLE PartTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                        pimItemId BIGINT NOT NULL,
                        partTypeId BIGINT NOT NULL,
                        data LONGBLOB,
                        datasize BIGINT NOT NULL,
                        version INTEGER DEFAULT 0,
                        storage TINYINT DEFAULT 0)


CREATE TABLE CollectionAttributeTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                                       collectionId BIGINT NOT NULL,
                                       type LONGBLOB NOT NULL,
                                       value LONGBLOB)

CREATE TABLE TagTypeTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                           name TEXT UNIQUE NOT NULL)

INSERT INTO TagTypeTable (name) VALUES ('PLAIN')

CREATE TABLE TagTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                       gid TEXT NOT NULL,
                       parentId BIGINT,
                       typeId BIGINT DEFAULT 1)

CREATE TABLE TagAttributeTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                                tagId BIGINT NOT NULL,
                                type LONGBLOB NOT NULL,
                                value LONGBLOB)

CREATE TABLE TagRemoteIdResourceRelationTable (tagId BIGINT NOT NULL,
                                               resourceId BIGINT NOT NULL,
                                               remoteId TEXT NOT NULL)

CREATE TABLE RelationTypeTable (id INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
                                name TEXT UNIQUE NOT NULL)

INSERT INTO RelationTypeTable (name) VALUES ('GENERIC')

CREATE TABLE RelationTable (leftId BIGINT NOT NULL,
                            rightId BIGINT NOT NULL,
                            typeId BIGINT DEFAULT 1,
                            remoteId TEXT)

CREATE TABLE PimItemFlagRelation (PimItem_id BIGINT NOT NULL,
                                  Flag_id BIGINT NOT NULL,
                                  PRIMARY KEY (PimItem_id, Flag_id))

CREATE TABLE PimItemTagRelation (PimItem_id BIGINT NOT NULL,
                                 Tag_id BIGINT NOT NULL,
                                 PRIMARY KEY (PimItem_id, Tag_id))

CREATE TABLE CollectionMimeTypeRelation (Collection_id BIGINT NOT NULL,
                                         MimeType_id BIGINT NOT NULL,
                                         PRIMARY KEY (Collection_id, MimeType_id))

CREATE TABLE CollectionPimItemRelation (Collection_id BIGINT NOT NULL,
                                        PimItem_id BIGINT NOT NULL,
                                        PRIMARY KEY (Collection_id, PimItem_id))

CREATE UNIQUE INDEX CollectionTable_parentAndNameIndex ON CollectionTable (parentId,name)

CREATE INDEX CollectionTable_parentIndex ON CollectionTable (parentId)

CREATE INDEX CollectionTable_resourceIndex ON CollectionTable (resourceId)

CREATE INDEX CollectionTable_enabledIndex ON CollectionTable (enabled)

CREATE INDEX CollectionTable_syncPrefIndex ON CollectionTable (syncPref)

CREATE INDEX CollectionTable_displayPrefIndex ON CollectionTable (displayPref)

CREATE INDEX CollectionTable_indexPrefIndex ON CollectionTable (indexPref)

CREATE INDEX PimItemTable_collectionIndex ON PimItemTable (collectionId)

CREATE INDEX PimItemTable_mimeTypeIndex ON PimItemTable (mimeTypeId)

CREATE INDEX PimItemTable_gidIndex ON PimItemTable (gid)

CREATE INDEX PimItemTable_ridIndex ON PimItemTable (remoteId)

CREATE INDEX PimItemTable_idSortIndex ON PimItemTable (id DESC)

CREATE UNIQUE INDEX PartTypeTable_partTypeNameIndex ON PartTypeTable (ns,name)

CREATE UNIQUE INDEX PartTable_pimItemIdTypeIndex ON PartTable (pimItemId,partTypeId)

CREATE INDEX PartTable_pimItemIdSortIndex ON PartTable (pimItemId DESC)

CREATE INDEX PartTable_partTypeIndex ON PartTable (partTypeId)

CREATE INDEX CollectionAttributeTable_collectionIndex ON CollectionAttributeTable (collectionId)

CREATE INDEX TagTable_parentIndex ON TagTable (parentId)

CREATE INDEX TagTable_typeIndex ON TagTable (typeId)

CREATE INDEX TagAttributeTable_tagIndex ON TagAttributeTable (tagId)

CREATE UNIQUE INDEX TagRemoteIdResourceRelationTable_TagAndResourceIndex ON TagRemoteIdResourceRelationTable (tagId,resourceId)

CREATE INDEX TagRemoteIdResourceRelationTable_tagIndex ON TagRemoteIdResourceRelationTable (tagId)

CREATE INDEX TagRemoteIdResourceRelationTable_resourceIndex ON TagRemoteIdResourceRelationTable (resourceId)

CREATE UNIQUE INDEX RelationTable_RelationIndex ON RelationTable (leftId,rightId,typeId)

CREATE INDEX RelationTable_leftIndex ON RelationTable (leftId)

CREATE INDEX RelationTable_rightIndex ON RelationTable (rightId)

CREATE INDEX RelationTable_typeIndex ON RelationTable (typeId)

CREATE INDEX PimItemFlagRelation_PimItem_idIndex ON PimItemFlagRelation (PimItem_id)

CREATE INDEX PimItemFlagRelation_Flag_idIndex ON PimItemFlagRelation (Flag_id)

CREATE INDEX PimItemFlagRelation_pimItemIdSortIndex ON PimItemFlagRelation (pimitem_id DESC)

CREATE INDEX PimItemTagRelation_PimItem_idIndex ON PimItemTagRelation (PimItem_id)

CREATE INDEX PimItemTagRelation_Tag_idIndex ON PimItemTagRelation (Tag_id)

CREATE INDEX CollectionMimeTypeRelation_Collection_idIndex ON CollectionMimeTypeRelation (Collection_id)

CREATE INDEX CollectionMimeTypeRelation_MimeType_idIndex ON CollectionMimeTypeRelation (MimeType_id)

CREATE INDEX CollectionPimItemRelation_Collection_idIndex ON CollectionPimItemRelation (Collection_id)

CREATE INDEX CollectionPimItemRelation_PimItem_idIndex ON CollectionPimItemRelation (PimItem_id)
